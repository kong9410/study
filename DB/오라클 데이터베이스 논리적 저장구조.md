# 오라클 데이터베이스 논리적 저장구조

## 구조

![오라클 DB의 논리적/물리적 구조](http://www.dbguide.net/publishing/img/dbguide/oracle/oracle2_1.jpg)

오라클 데이터베이스는 논리적 구조와 물리적 구조로 이루어져있다.

사용자들이 알고 있는 데이터베이스는 논리적 개념이며, 데이터의 집합을 말한다.

Tablespace라는 여러개의 논리적 구조가 모여서 하나의 데이터베이스를 이룬다.



## Tablespace

데이터베이스는 논리적 저장 영역 단위인 테이블스페이스로 나누어진다.

하나 이상의 데이터파일은 개별 테이블스페이스를 구성, 테이블스페이스 내에 존재하는 모든 논리적 객체정보를 저장하게 된다.

일반적으로 유니버셜 인스톨러에 의해 3개(SYSTEM, UNDOTBS, TEMP)의 테이블스페이스가 생성되며, 사용자에 의해 추가적으로 여러 개의 테이블스페이스가 생성될 수 있다.

#### SYSTEM 테이블스페이스

데이터베이스가 제공하는 자료사전(Data Dictionary) 테이블

데이터베이스 내에 생성되어 있는 모든 객체들에 대한 정보뿐 아니라 데이터베이스의 현재 상태를 보여줌

데이터 베이스의 모든 상태정보가 저장되어 있는 공간

```sql
CONNECT system/manager
SELECT * FROM DBA_USERS;
SELECT * FROM DBA_DATA_FILES;
```

#### UNDOTBS 테이블스페이스

사용자들이 데이터베이스에 접속한 다음 DML을 실행후에 트랜잭션을 취소해야 하면 rollback문을 수행

변경전의 값이 잠시 저장되는 공간

#### TEMPORARY

대부분의 사용자들이 실행하는 쿼리를 ORDER BY, GROUP BY 등으로 분류하는 작업을 하는데 이 때 필요한 임시공간이 TEMP 테이블스페이스이다.

#### 데이터 파일

위의 테이블스페이스들은 CREATE DATABASE에 의해 오라클 데이터베이스에 의해 설치될 때 생성됨



## 세그멘트(Segment)

데이터베이스 내에 생성되는 모든 객체(테이블, 인덱스, 뷰, 시퀀스, 시노늄 등)를 세그먼트(Segment) 라고 한다.

종류

- 데이터 세그먼트

  클러스터 되지 않은 테이블, 클러스터 테이블, 파티션 테이블로 구분 된다.

- 인덱스 세그먼트

  일반 index와 partitioned index는 각각 자신의 모든 데이터를 저장하고 있는 하나의 인덱스 세그먼트를 갖는다.

- 임시 세그먼트

  임시 작업 영역이 필요할 때 생성

- Undo세그먼트

  Rollback 세그먼트와 같음(9i 이전 버전)

  트랜잭션 롤백, 읽기 일관성 유지, 트랜잭션 복구를 위해 사용됨

오라클은 세그먼트 확장 영역이 꽉 차면 동적으로 영역을 할당한다.

새로 할당되는 세그먼트의 영역은 디스크에서 연속적인 부분이 아닐 수 있다.

## 익스텐트(Extent)

하나의 세그먼트는 여러개의 익스텐트가 모여서 구성된다.

하나의 테이블을 처음부터 큰 저장공간에 할당하는 것이 아닌 처음에는 익스텐트라는 공간이 할당되고 이 공간이 모두 사용되면 다시 익세텐트를 할당 받아 연속적으로 데이터를 저장하게 된다.

한 테이블은 연속적인 공간이 아닌 익스텐트라는 작은 구성요소가 모여 생성된다.

## 블록(Block)

오라클 데이터베이스에서 가장 작은 저장구조

익스텐트도 여러개의 블록이 모여서 만들어진 것이다.

이렇게 익스텐트를 여러 블록으로 나눈 이유는, 만일 익스텐트가 연속적인 공간에 만들어져있다면 테이블의 데이터를 읽을 때마다 한번에 많은 데이터를 가져와야 하기 때문에 시간이 많이 소요되고, 한번에 많은 데이터를 저장해야하기 때문에 효과적인 저장과 관리가 용이하지 않기 때문이다.